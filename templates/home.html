{% extends 'base.html' %}
{% load static %}
{% block style %}
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <style>
        .edit-icon {
            font-size: 12px;
            color: #9a9595;
        }

        .fas.fa-star, .fas.fa-comment, .fas.fa-heart {
            color: #9a9595;
            font-size: 14px;
        }

        .liked {
            color: red !important;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgb(0, 0, 0);
            background-color: rgba(0, 0, 0, 0.4);
        }

        .modal-content {
            background-color: #fefefe;
            margin: 15% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
            animation-name: animatetop;
            animation-duration: 0.4s;
        }

        @keyframes animatetop {
            from {
                top: -300px;
                opacity: 0;
            }
            to {
                top: 0;
                opacity: 1;
            }
        }
    </style>
{% endblock %}
{% block content %}
    <div class="flex-container" style="margin-top: 30px">
        <table id="hnmain" class="main-table">
            <tr>
                <td class="header-cell">
                    <div class="header-container"
                         style="display: flex; justify-content: space-between; align-items: center; padding: 5px;">
                        <div class="logo-links">
                            <a href="{% url 'index' %}">
                                <img src="{% static 'img/icon.png' %}" alt="Hacker News Logo">
                            </a>
                            <span class="pagetop">
                                <b class="hnname"><a href="{% url 'index' %}">Ai-News</a></b>
                            </span>
                        </div>
                        <div class="search-login">
                            <form method="get" action="search" style="display: inline;">
                                <input type="text" name="q" value="" size="17" autocorrect="off" spellcheck="false"
                                       autocapitalize="off" autocomplete="off" placeholder="Search">

                            </form>
                            {% if user.is_authenticated %}
                                <a href="{% url 'profile' %}"
                                   style="border: 1px solid black;margin-right: 5px;margin-left: 5px;border-radius: 5px">
                                    <p style="display: inline;font-size: 16px;margin-left: 5px">{{ user.username|capfirst }}</p>
                                </a>


                                {% if user.is_superuser %}
                                    <a href="{% url 'add_news' %}">Add News</a>
                                {% endif %}
                                <a href="{% url 'logout' %}">logout</a>
                            {% else %}
                                <a href="{% url 'login' %}">login</a>
                            {% endif %}
                        </div>
                    </div>
                </td>
            </tr>
            <tr>
                <td class="spacer-cell"></td>
            </tr>
            <tbody class="news-item">
            {% for new in news %}
                <tr class="news-row">
                    <td>
                        <table class="news-item">
                            <tr class="athing" id="news_{{ new.id }}">
                                <td class="rank-cell">{{ forloop.counter }}.</td>
                                <td class="vote-cell">
                                    <center><a id="up_{{ new.id }}" href="vote?id={{ new.id }}&how=up&goto=news">
                                        <div class="votearrow" title="upvote"></div>
                                    </a></center>
                                </td>
                                <td class="title-cell">
                                    <a href="{{ new.link }}">{{ new.short_description }}</a>
                                    <span class="sitebit comhead">(<a
                                            href="{{ new.link }}">{{ new.category }}</a>)</span>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2"></td>
                                <td class="subtext-cell">
                                    {% if user.is_authenticated %}
                                        <a href="{% url 'rating_view' new.id %}" class="rating-icon"
                                           data-news-id="{{ new.id }}">
                                            <i class="fas fa-star"></i>
                                        </a>
                                    {% else %}
                                        <a href="{% url 'login' %}" class="rating-icon">
                                            <i class="fas fa-star"></i>
                                        </a>
                                    {% endif %}

                                    <span class="score" id="score_{{ new.id }}">
                                {{ new.average_rating|floatformat:1|default:0 }}
                            </span>
                                    |
                                    by {{ user }}
                                    <span class="age">{{ new.time_ago }}</span> |
                                    {% if user.is_authenticated %}
                                        <a href="{% url 'comment_view' new.id %}">
                                            <i class="fas fa-comment"></i>
                                        </a>
                                    {% else %}
                                        <a href="{% url 'login' %}">
                                            <i class="fas fa-comment"></i>
                                        </a>
                                    {% endif %}


                                    <a href="item?id={{ new.id }}"
                                       id="comment_count_{{ new.id }}">{{ new.comments.count }}</a>|

                                    {% if user.is_authenticated %}

                                        <a href="{% url 'like_view' new.id %}"
                                           class="like-icon {% if new.user_liked %}liked{% endif %}"
                                           data-news-id="{{ new.id }}">
                                            <i class="fas fa-heart"></i>
                                        </a>
                                    {% else %}
                                        <a href="{% url 'login' %}" class="like-icon">
                                            <i class="fas fa-heart"></i>
                                        </a>
                                    {% endif %}
                                    <span class="likes-count" id="likes_count_{{ new.id }}">
                                {{ new.likes.count }}
                            </span>
                                    |
                                    {% if request.user.is_superuser %}
                                        <a href="{% url 'edit_news' new.id %}"><i
                                                class="fas fa-pencil-alt edit-icon"></i></a>
                                    {% endif %}
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            {% endfor %}
            </tbody>

            <tr>
                <td class="footer-cell">
                    <div style="display: flex; justify-content: center; align-items: center; height: 30px;">
            <span class="yclinks">
                <a href="http://umutins62.pythonanywhere.com/" target="_blank">About</a> | <a
                    href="{% url 'faq' %}">FAQ</a>

            </span>
                    </div>
                </td>
            </tr>
        </table>
    </div>
    <footer class="footer-container">
        <div class="social-media-links">
            <a href="https://www.github.com/palamut62" target="_blank"><i class="fab fa-github"></i></a>
            <a href="https://www.twitter.com/palamut62" target="_blank"><i class="fab fa-twitter"></i></a>
            <a href="https://www.instagram.com/umutins6230" target="_blank"><i class="fab fa-instagram"></i></a>
            <a href="https://www.linkedin.com/in/" target="_blank"><i class="fab fa-linkedin-in"></i></a>
            <a href="http://umutins62.pythonanywhere.com/" target="_blank"><i class="fas fa-globe"></i></a>
        </div>
        <p class="design-credit">Design by Umut Celik | 2024</p>
    </footer>
    <script src="hn.js"></script>
    <script>

    </script>
    {% include 'comments.html' %}
    {% include 'points.html' %}
{% endblock %}
